<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    x:Class="DViewer.FullscreenImagePage"
    BackgroundColor="Black">

    <Grid x:Name="Root" BackgroundColor="Black">

        <!-- Bild -->
        <Image x:Name="Img"
               Aspect="AspectFit"
               HorizontalOptions="Center"
               VerticalOptions="Center" />

        <!-- PATIENT OVERLAY (oben links) -->
        <Grid HorizontalOptions="Start"
              VerticalOptions="Start"
              Margin="12"
              Padding="10"
              BackgroundColor="#66000000"
              MaximumWidthRequest="600"
              InputTransparent="True">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <Label Grid.Row="0"
                   Text="{Binding PatientNameWithSex}"
                   FontAttributes="Bold" TextColor="White"
                   LineBreakMode="TailTruncation" MaxLines="1"/>

            <Grid Grid.Row="1" ColumnDefinitions="Auto,*" ColumnSpacing="6">
                <Label Grid.Column="0" Text="Species" FontAttributes="Italic" TextColor="#DDFFFFFF"/>
                <Label Grid.Column="1" Text="{Binding Species}" TextColor="White"
                       LineBreakMode="TailTruncation" MaxLines="1"/>
            </Grid>

            <Grid Grid.Row="2" ColumnDefinitions="Auto,*" ColumnSpacing="6">
                <Label Grid.Column="0" Text="PID" FontAttributes="Italic" TextColor="#DDFFFFFF"/>
                <Label Grid.Column="1" Text="{Binding PatientID}" TextColor="White"
                       LineBreakMode="TailTruncation" MaxLines="1"/>
            </Grid>

            <Grid Grid.Row="3" ColumnDefinitions="Auto,*" ColumnSpacing="6">
                <Label Grid.Column="0" Text="DOB" FontAttributes="Italic" TextColor="#DDFFFFFF"/>
                <Label Grid.Column="1" Text="{Binding BirthDateDisplay}" TextColor="White"/>
            </Grid>

            <Grid Grid.Row="4" ColumnDefinitions="Auto,*" ColumnSpacing="6">
                <Label Grid.Column="0" Text="Other PID" FontAttributes="Italic" TextColor="#DDFFFFFF"/>
                <Label Grid.Column="1" Text="{Binding OtherPid}" TextColor="White"
                       LineBreakMode="TailTruncation" MaxLines="1"/>
            </Grid>
        </Grid>

        <!-- WINDOW/LEVEL READOUT (rechts mittig) -->
        <Grid HorizontalOptions="End"
              VerticalOptions="Center"
              Margin="12"
              Padding="12"
              BackgroundColor="#66000000"
              InputTransparent="True">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <Label Grid.Row="0" Text="Window / Level" FontAttributes="Bold" TextColor="White" />
            <Grid Grid.Row="1" ColumnDefinitions="Auto,*" ColumnSpacing="10">
                <Label Grid.Column="0" Text="Center" TextColor="#DDFFFFFF" />
                <Label Grid.Column="1" Text="{Binding WindowCenter, StringFormat='{}{0:0}'}" TextColor="White"/>
            </Grid>
            <Grid Grid.Row="2" ColumnDefinitions="Auto,*" ColumnSpacing="10">
                <Label Grid.Column="0" Text="Width"  TextColor="#DDFFFFFF" />
                <Label Grid.Column="1" Text="{Binding WindowWidth, StringFormat='{}{0:0}'}" TextColor="White"/>
            </Grid>
        </Grid>

        <!-- FRAME OVERLAY (unten rechts) -->
        <Grid HorizontalOptions="End"
              VerticalOptions="End"
              Margin="12"
              Padding="8"
              BackgroundColor="#66000000"
              InputTransparent="True">
            <Label Text="{Binding FramePositionText}" TextColor="White" FontAttributes="Bold"/>
        </Grid>

        <!-- Gesten -->
        <Grid.GestureRecognizers>
            <TapGestureRecognizer NumberOfTapsRequired="1" Tapped="OnCloseTapped" />
            <TapGestureRecognizer NumberOfTapsRequired="2" Tapped="OnDoubleTapped" />
            <PinchGestureRecognizer PinchUpdated="OnPinchUpdated" />
            <PanGestureRecognizer PanUpdated="OnPanUpdated" TouchPoints="1" />
            <PanGestureRecognizer PanUpdated="OnWlPanUpdated" TouchPoints="2" />
        </Grid.GestureRecognizers>

    </Grid>
</ContentPage>
